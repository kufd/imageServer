imageServer 1.0


Опис 
Це сервер який дозволяє отримувати зображення по HTTP протоколу, а також дозволяє маніпулювати цими зображеннями. Всі зображення які проходять обробку кешуються і в результаті їх повторна віддача э набагато швидшою.
Розроблявся на Fedora Linux. На інших системах не тестувався.


Установка
Необхідна наявність бібліотек: ImageMagick, Openssl.
Далі необхідгл скомпілювати бібліотеки в папці libs, а потім сам сервер в кореневій папці проекту.


Налаштування
Файл налаштувань має знаходитись за таким шляхом /etc/imageServer/imageServer.conf або відносно запускаючого файлу conf/imageServer.conf


Список налаштувань
#Шлях до лог-файлу 
log = logs/imageServer.log

#Шлях до лог-файлу помилок
logError = logs/imageServer-error.log

#Рівень детальності логів
logLevel = 3

#Порт який слухає сервер
port = 1111

#Шлях до каталогу з малюнками
imagesDir = /home/kufd/C++/imageServer/img

#Шлях до кешу
cacheDir = /home/kufd/C++/imageServer/cache

#режим демона (yes, no)
daemon = no




Маніпуляція зображеннями

Список параметрів

ad - час кешування у днях, якщо ad=0 то файл не кешується
top - y - координата верхнього лівого кута
left - x - координата верхнього лівого кута
bottom - y - координата нижнього правого кута
right - x - координата нижнього правого кута
w - ширина
h - висота
autocrop - визначає де вирізати область для дії cut_resize_proportion
f - шлях до файлу
fd - альтернативний файл для обробки, використовується якщо не відкрився файл заданий параметром f
wlb - ширина рамки малюнка яка робиться світлішою. По замовчуванню дорівнює 0.
bs (bigger side) - цей параметр використовується лише для дії resize_proportion. 
                   Якщо він заданий то більшій стороні малюнка присвоюється його значення, 
				   а довжина іншої сторони обчислюється автоматично враховуючи пропорції.
				   Цей параметр має вищий приорітете ніж параметри w і h.

fc{i=1,2,3...} - шлях до файлу, який потрібно накласти на основний
fcLeft{i=1,2,3...} - x - координата верхнього лівого кута малюнка, який накладається на основний
fcTop{i=1,2,3...} - y - координата верхнього лівого кута, який накладається на основний
fcRight{i=1,2,3...} - x - координата нижнього правого кута малюнка, який накладається на основний
fcBottom{i=1,2,3...} - y - координата нижнього правого кута, який накладається на основний
fcType{i=1,2,3...} - Метод композиції малюнків (copy - Результат - частина основного зображення замінена, plus - Результат - сума  даних зображення);

convertTo - Конвертувати результуюче зображення у gif, jpg, png

sm - параметр визначає чи потрібно виконувати обробку малюнка якщо його ширина і висота меньша від параметрів w, h. Використовується тільки для дії resize_proportion
Можливі значення параметра sm
0 - не виконувати
1 - виконувати
По замовчуванню значення 1


Можливість вирівнювання малюнка на підкладці при дії resizeProportion
align - вирівнювання по горизонталі(Значення: left, right, center)(За замовчуванням: center)
valign - вирівнювання по вертикалі(Значення: top, bottom, middle)(За замовчуванням: middle)


action - назва або номер дії яку потрібно виконати з малюнком
Можливі значення параметра action
1 - cut - вирізати з малюнк область задану параметрами top, left, bottom, right
2 - resize - стиснути малюнок до розмірів w, h (не працює)
3 - resizeProportion - 	пропорційно стиснути малюнок до розмірів w, h. 
						Якщо задані обидва параметри то вихідний малюнок буде мати розміри w, h, а з боків і верху будуть додати білі полоски, якщо буде потрібно. 
						Якщо заданий лише один з параметрів w, h то інший обчислюється автоматично враховуючи пропорції
4 - cutResizeProportion - 	Вирізає нійбільшу можливу область пропрорційну до параметрів w, h область. 
							Початок вирізаної області може визначатися параметрорм autocrop який зараз може приймати лише 1 значення "center"(по замовчуванню) яке вказує що область тре вирізатив центрі. 
							Далі малюнок стискається до розмірів w, h.
Якщо не вказаний параметр action то зображення виводиться без будь якої обробки (напряму з файла джерала).














